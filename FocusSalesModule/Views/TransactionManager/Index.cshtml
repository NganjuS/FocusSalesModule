
@{
    Layout = null;
}
@using System.Data;

<!DOCTYPE html>
<html>
<head>
    <title>Transactions Manager</title>
    <link type="text/css" rel="stylesheet" href="~/Content/bootstrap.min.css" />
    <link rel="stylesheet" href="~/Content/sweetalert2.min.css" />
    <style>
        .thcolor {
            color: white;
            background-color: #0073AA;
        }

        td.wrap {
            word-break: break-all; /* breaks anywhere */
            overflow-wrap: break-word; /* ensures wrapping */
        }
    </style>
</head>
<body x-data="transactionManager" style="font-size: 14px;">
    <div class="container">
        <div class="card" style="margin-top:20px;">
            <div class="card-header bg-light">
                <div class="row">
                    <div class="col-md-3">
                        <h3 class="panel-title" style="color: #0073AA;">Moniepoint Txns</h3>

                    </div>
                    <div class="col-md-3">
                        <input type="search" class="form-control" id="searchItems" placeholder="search ..." x-model="searchVal" @@input="debouncedInput" />
                    </div>
                    <div class="col-md-3">
                        <input type="hidden" id="compid" value="@ViewBag.compid" x-ref="compid" />
                    </div>
                    <div class="col-md-3">
                        <div class="hstack gap-1" style="float: right;">
                            <button class="btn" id="btnSave" x-on:click="resetFilters()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
                                    <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z" />
                                    <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466" />
                                </svg>
                                <br />Refresh
                            </button>
                            @*<button class="btn" id="btnSave" x-on:click="initExportInvoices()">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-printer" viewBox="0 0 16 16">
                                        <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1" />
                                        <path d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1" />
                                    </svg>
                                    <br />Print
                                </button>*@

                            <button class="btn" x-on:click="closeWin()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-backspace" viewBox="0 0 16 16">
                                    <path d="M5.83 5.146a.5.5 0 0 0 0 .708L7.975 8l-2.147 2.146a.5.5 0 0 0 .707.708l2.147-2.147 2.146 2.147a.5.5 0 0 0 .707-.708L9.39 8l2.146-2.146a.5.5 0 0 0-.707-.708L8.683 7.293 6.536 5.146a.5.5 0 0 0-.707 0z" />
                                    <path d="M13.683 1a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-7.08a2 2 0 0 1-1.519-.698L.241 8.65a1 1 0 0 1 0-1.302L5.084 1.7A2 2 0 0 1 6.603 1zm-7.08 1a1 1 0 0 0-.76.35L1 8l4.844 5.65a1 1 0 0 0 .759.35h7.08a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z" />
                                </svg>
                                <br />
                                Close
                            </button>
                        </div>


                    </div>
                </div>

            </div>
            <div class="card-body" style="padding:10px;">

                <table class="table table-bordered table-sm" id="paymentlist" style="margin-top: 5px;">
                    <thead style="color: white !important; background-color: #0073AA !important;">
                        <tr>
                            <th style="color: white !important; background-color: #0073AA !important;">##</th>
                            <th style="color: white !important; background-color: #0073AA !important;"> Outlet</th>
                            <th style="color: white !important; background-color: #0073AA !important;">T. Reference</th>
                            <th style="color: white !important; background-color: #0073AA !important;">T. Time</th>
                            <th style="color: white !important; background-color: #0073AA !important;">Amount</th>
                            <th style="color: white !important; background-color: #0073AA !important;">TerminalSerial</th>
                            <th style="color: white !important; background-color: #0073AA !important;">TransactionType</th>
                            <th style="color: white !important; background-color: #0073AA !important;">TransactionStatus</th>
                            <th style="color: white !important; background-color: #0073AA !important;">Allocated</th>
                            <th style="color: white !important; background-color: #0073AA !important;">Is Valid</th>
                            <th style="color: white !important; background-color: #0073AA !important;">##</th>
                        </tr>
                    </thead>
                    <tbody>
                        <template x-for="(row,index) in paymentList" :key="index">
                            <tr>
                                <th scope="row" x-text="(((currentPage-1)*pagingData.pageSize)+index+1)+'.'"></th>
                                <td class="wrap" x-text="row.OutletName"> </td>
                                <td class="wrap" x-text="row.TransactionReference"></td>
                                <td class="wrap" x-text="row.TransactionTime"></td>
                                <td x-text="formatNum(row.AmountInLocalCur)"></td>
                                <td x-text="row.TerminalSerial"></td>
                                <td x-text="row.TransactionType"></td>
                                <td x-text="row.TransactionStatus"></td>
                                <td style="text-align: center;"><span class="badge" :class="{ 'bg-success' : row.IsAllocatedToSale, 'bg-warning' : !row.IsAllocatedToSale }" x-text="row.IsAllocatedToSale ? 'Yes' : 'No'"></span></td>
                                <td style="text-align: center;">
                                    <span class="badge" :class="{ 'bg-success' : getIsTxnValid(row), 'bg-danger' : !getIsTxnValid(row) }" x-text="getIsTxnValid(row) ? 'Yes' : 'No'"></span>

                                </td>
                                <td>
                                    <button class="btn" @@click="openEditModal(row)">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                            <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z" />
                                            <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z" />
                                        </svg>
                                    </button>
                                </td>
                            </tr>
                        </template>
                    </tbody>
                </table>



                <div class="row">
                    <div class="col-md-8">
                        <nav aria-label="Page navigation example">
                            <ul class="pagination">
                                <li class="page-item">
                                    <a class="page-link" @@click="prevGroup()" aria-label="Previous">
                                        <span aria-hidden="true">&laquo;</span>
                                    </a>
                                </li>
                                <template x-for="page in pagingData.curVisiblePages" :key="page">
                                    <li class="page-item" :class="{'active': currentPage === (pagingData.startingPage+page)}"><a class="page-link" href="#" x-on:click="currentGroup(pagingData.startingPage+page)" x-text="pagingData.startingPage + page"></a></li>


                                </template>
                                <li class="page-item">
                                    <a class="page-link" href="#" @@click="nextGroup()" aria-label="Next">
                                        <span aria-hidden="true">&raquo;</span>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                    <div class="col-md-4">
                        <span x-text="pagingData.pagingDesc"> </span>
                    </div>
                </div>


            </div>
        </div>
    </div>
    <!-- Edit Modal -->
    <!-- Modal -->
    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Modal title</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    ...
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Understood</button>
                </div>
            </div>
        </div>
    </div>
    <!-- End Edit-->

    <script src="~/Scripts/FClient.js"></script>
    <script src="~/Scripts/jquery-3.7.0.min.js"></script>
    <script src="~/Scripts/bootstrap.bundle.min.js"></script>
    <script src="~/Scripts/sweetalert2.all.min.js"></script>
    <script src="~/Scripts/pos/transactionsmanager.js?v=jksa00s99shsddsj"></script>
    <script src="~/Scripts/alpine.min.js"></script>
</body>
</html>